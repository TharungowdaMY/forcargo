{% extends "base.html" %}
{% block content %}

<h1 class="page-title">âœˆï¸ Forwarder Search</h1>

<!-- SEARCH FORM -->
<div class="glass-card">
    <form method="POST" class="search-grid">
        <input name="origin" placeholder="Origin (DEL)" required>
        <input name="destination" placeholder="Destination (LHR)" required>
        <input type="date" name="date" required>
        <button class="neon-btn">Search</button>
    </form>
</div>

{% if results or interline %}

<!-- MATRIX SUMMARY -->
<div class="matrix-header">

    <div class="matrix-box best">
        <h4>ğŸ¯ Best Value</h4>
        <p>{{ best_value.price }} â‚¹/kg</p>
        <small>{{ best_value.transit|round(1) }} hrs</small>
    </div>

    <div class="matrix-box cheap">
        <h4>ğŸ’° Cheapest</h4>
        <p>{{ cheapest.price }} â‚¹/kg</p>
        <small>{{ cheapest.transit|round(1) }} hrs</small>
    </div>

    <div class="matrix-box fast">
        <h4>âš¡ Quickest</h4>
        <p>{{ quickest.transit|round(1) }} hrs</p>
        <small>{{ quickest.price }} â‚¹/kg</small>
    </div>

</div>

{% endif %}

<!-- DIRECT FLIGHTS -->
<h3 class="section-title">âœˆ Direct Flights</h3>

{% if results %}
    {% for f in results %}
        <div class="flight-card">

            <h4>{{ f['airline'] }} {{ f['flight_no'] }}</h4>

            <div class="route">
                {{ f['origin'] }} â†’ {{ f['destination'] }}
            </div>

            <div class="time-box">
                ğŸ•’ {{ f['departure_time'] }} â†’ {{ f['arrival_time'] }}
                ({{ f['duration_minutes'] }} mins)
            </div>

            <div>
                ğŸ“¦ Capacity: {{ f['capacity'] }} kg
                | Cargo: {{ f['cargo_type'] }}
            </div>

            <form method="POST" action="/book">
                <input type="hidden" name="flight_id" value="{{ f['id'] }}">

                <input type="number" name="actual_weight" placeholder="Weight (kg)" required>

                <input type="number" name="length" placeholder="Length (cm)" required>
                <input type="number" name="width" placeholder="Width (cm)" required>
                <input type="number" name="height" placeholder="Height (cm)" required>

                <button class="neon-btn">ğŸ“Œ Hold</button>
            </form>

        </div>
    {% endfor %}
{% else %}
    <p>No direct flights found.</p>
{% endif %}

<!-- INTERLINE ROUTES -->
<h3 class="section-title">ğŸ” Interline Routes</h3>

{% if interline %}
    {% for r in interline %}

        <div class="interline-card">

            <h4>
                {{ r.legs[0]['origin'] }}
                â†’ {{ r.legs[0]['destination'] }}
                â†’ {{ r.legs[1]['destination'] }}
            </h4>

            <!-- LEG 1 -->
            <div class="leg-box">
                âœˆ {{ r.legs[0]['airline'] }} {{ r.legs[0]['flight_no'] }}
                ğŸ•’ {{ r.legs[0]['departure_time'] }} â†’ {{ r.legs[0]['arrival_time'] }}
                ({{ r.legs[0]['duration_minutes'] }} mins)
            </div>

            <!-- LEG 2 -->
            <div class="leg-box">
                âœˆ {{ r.legs[1]['airline'] }} {{ r.legs[1]['flight_no'] }}
                ğŸ•’ {{ r.legs[1]['departure_time'] }} â†’ {{ r.legs[1]['arrival_time'] }}
                ({{ r.legs[1]['duration_minutes'] }} mins)
            </div>

            <!-- TOTAL TIME -->


            <form method="POST" action="/book">
                <input type="hidden" name="flight_id" value="{{ r.legs[0]['id'] }}">

                <input type="number" name="actual_weight" placeholder="Weight (kg)" required>

                <input type="number" name="length" placeholder="Length (cm)" required>
                <input type="number" name="width" placeholder="Width (cm)" required>
                <input type="number" name="height" placeholder="Height (cm)" required>

                <button class="neon-btn">ğŸ“Œ Hold Interline</button>
            </form>

        </div>

    {% endfor %}
{% else %}
    <p>No interline routes found.</p>
{% endif %}

<style>
.page-title {
    color:#fff;
    margin-bottom:20px;
}

.glass-card {
    background:rgba(255,255,255,0.06);
    padding:20px;
    border-radius:14px;
    backdrop-filter: blur(10px);
    margin-bottom:25px;
}

.search-grid {
    display:grid;
    grid-template-columns: repeat(4, 1fr);
    gap:15px;
}

.matrix-header {
    display:flex;
    gap:20px;
    margin:30px 0;
}

.matrix-box {
    flex:1;
    padding:18px;
    border-radius:14px;
    text-align:center;
    color:#fff;
    box-shadow:0 0 15px rgba(0,0,0,0.5);
}

.matrix-box.best { background:linear-gradient(135deg,#ff0080,#ff8c00); }
.matrix-box.cheap { background:linear-gradient(135deg,#00c6ff,#0072ff); }
.matrix-box.fast { background:linear-gradient(135deg,#00ff99,#00cc66); }

.section-title {
    color:#ff2ebd;
    margin:30px 0 15px;
}

.route-card {
    background:#0b0b0b;
    border:1px solid #222;
    border-radius:14px;
    padding:18px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:15px;
}

.hold-form {
    display:flex;
    gap:8px;
}

input {
    background:#111;
    border:1px solid #333;
    color:#fff;
    padding:6px 8px;
    border-radius:6px;
}

.neon-btn {
    background:#ff0077;
    color:white;
    border:none;
    padding:8px 16px;
    border-radius:20px;
    cursor:pointer;
    box-shadow:0 0 10px #ff0077;
}

.neon-btn:hover {
    background:#ff2ebd;
}

.muted {
    color:#777;
}
</style>

{% endblock %}
